#!/bin/bash -ue

activate-hotkeys() {
    # Kill residual xcape/xbindkeys processes
    pgrep xbindkeys > /dev/null && pkill xbindkeys
    pgrep xcape     > /dev/null && pkill xcape

    # Modifiers
    xmodmap ~/.Xmodmap
    xcape -e "Hyper_L=Escape;Super_L=Super_L|F12"

    # Keybindings
    cat ~/.config/xbindkeys/keyboard > /tmp/xbindkeysrc
    if xinput --list --short | grep -q "M720.*pointer"; then
        cat ~/.config/xbindkeys/logitech-m720 >> /tmp/xbindkeysrc
    fi
    xbindkeys -f /tmp/xbindkeysrc
}

setup-mouse-scroll-speed() {
    if xinput --list --short | grep -q "M720.*pointer"; then
        pgrep imwheel > /dev/null && pkill imwheel
        imwheel > /dev/null 2>&1
    fi
}


# 
# Main
#
activate-hotkeys
setup-mouse-scroll-speed
