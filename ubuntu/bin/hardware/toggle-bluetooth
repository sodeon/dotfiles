#!/bin/bash -ue

#------------------------------------------------------------------------------
# Use rfkill to power down bluetooth rx/tx.
# It is not clear whether using blacklist bluetooth kernel module disables bluetooth or power down bluetooth
#
# Reference: https://stackoverflow.com/questions/818255/in-the-shell-what-does-21-mean
#------------------------------------------------------------------------------
is-bluetooth-enabled() {
    rfkill --output TYPE,SOFT | grep bluetooth | grep -q unblocked
}

disable-bluetooth() {
    rfkill block   bluetooth; sudo systemctl disable bluetooth.service 2> /dev/null; sudo systemctl stop  bluetooth.service; notify-send "Bluetooth disabled"
}

enable-bluetooth() {
    rfkill unblock bluetooth; sudo systemctl enable  bluetooth.service 2> /dev/null; sudo systemctl start bluetooth.service; notify-send "Bluetooth enabled"
}

is-bluetooth-enabled && disable-bluetooth || enable-bluetooth
