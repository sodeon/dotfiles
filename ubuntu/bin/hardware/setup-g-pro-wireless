#!/bin/bash -u
is_left_hand_mouse=${1-""}

if ! xinput | grep -q 'Logitech G Pro\s*id'; then # G Pro in wireless mode
    # sudo systemctl stop input-remapper.service

    cd ~/.config/i3
    ./gen-config.hotkeys.sh
    i3-msg reload >/dev/null
    exit
fi

# sudo systemctl start input-remapper.service >/dev/null
# input-remapper-control --command autoload   >/dev/null

if [[ $is_left_hand_mouse != "" ]]; then
    cd ~/.config/i3
    ./gen-config.hotkeys.sh left-hand-mouse
    i3-msg reload >/dev/null
    # xinput | grep "Logitech G Pro\s*forwarded\s*id.*pointer" | sed -e 's/.*=//' -e 's/\[.*//' -e 's/\s*$//' | xargs -I _ xinput set-button-map _ 3 2 1 >/dev/null
else
    cd ~/.config/i3
    ./gen-config.hotkeys.sh
    i3-msg reload >/dev/null
    # xinput | grep "Logitech G Pro\s*forwarded\s*id.*pointer" | sed -e 's/.*=//' -e 's/\[.*//' -e 's/\s*$//' | xargs -I _ xinput set-button-map _ 1 2 3 >/dev/null
fi
