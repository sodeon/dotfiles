#-------------------------------------------------------------------------------------------
# Document for program installation after miinimal Ubuntu 18.04 installation
#
# NOTE:
# 1. Prefer apt packages to snap packages
#    Why?
#    1. snap is complete sandbox. Thus, using snap Chromium will disable gnome-shell-extension capabilities
#    2. theme won't be applied
#-------------------------------------------------------------------------------------------
# vim 8.0
sudo apt install vim

# console
sudo apt install guake
sudo apt install gawk tmux
sh -c "$(curl -fsSL https://raw.githubusercontent.com/robbyrussell/oh-my-zsh/master/tools/install.sh)"
rm -rf ~/.oh-my-zsh

# package managers
sudo apt install git aptitude python-pip

# file manager, music player, office, utilities (common programs)
sudo apt install ranger zsh htop fasd cmus
sudo apt install libreoffice
sudo apt install dos2unix highlight units exiftool mediainfo sshfs curl wget ssh tree

# gnome desktop customizations
sudo add-apt-repository ppa:communitheme/ppa
sudo apt install gnome-shell-extensions dconf-tools ubuntu-restricted-extras ubuntu-communitheme-session gnome-tweak-tool gir1.2-clutter chrome-gnome-shell
sudo apt install fonts-roboto fonts-firacode

# input methods, key bindings (system customizations)
sudo apt install fcitx fcitx-table-boshiamy
sudo apt install xbindkeys xautomation mokutil ddccontrol

# fun stuffs
sudo apt install cmatrix cowsay lolcat toilet sl figlet fortune

# build tools
sudo apt install gdb gcc g++ build-essential cmake make makeinfo

# npm (web development)
sudo apt install npm libpng-dev
sudo npm install -g npm@5.6.0
#sudo npm install -g npm@latest
sudo chown -R $USER:$(id -gn $USER) /home/andy/.config
#sudo npm install -g vtop # system monitor (not very useful)

# mto development
sudo apt install nginx mysql-server php php-fpm php7.2-mbstring php7.2-xml php7.2-mysql php7.2-gd composer 
mysql_secure_installation
sudo mysql -u root -p
# https://dev.mysql.com/doc/refman/8.0/en/set-password.html
sudo systemctl enable mysql
cd /etc/nginx/sites-available
sudo vim repo.test
cd ../sites-enabled
sudo rm default
sudo ln -s ../sites-available/repo.test .
sudo usermod -a -G andy www-data
getent group andy
#v /etc/group

sudo pip install awscli --upgrade --user
aws configure
git config --global credential.helper '!aws codecommit credential-helper $@'
git config --global credential.UseHttpPath true
git clone https://git-codecommit.us-east-1.amazonaws.com/v1/repos/fto_beta2


#-------------------------------------------------------------------------------------------
# Software config
#-------------------------------------------------------------------------------------------
# Disable firewall, ssh, web development
sudo systemctl disable ufw
sudo systemctl disable ssh
sudo systemctl disable nginx
sudo systemctl disable mysql
sudo systemctl disable php7.2-fpm

# Disable error report
sudo systemctl disable apport
sudo systemctl disable whoopsie

# When does ubuntu install these shits
sudo systemctl disable apache2
sudo systemctl disable apache-htcacheclean

# Disable password request after resuming from lock screen
gsettings set org.gnome.desktop.screensaver ubuntu-lock-on-suspend 'false'


# Monitor brightness control
sudo ddccontrol -p # list devices
sudo a+rw /dev/i2c-3 # enable read/write on i2c that drives the monitor
# NVIDIA proprietary driver has problems detecting monitors
# Following workaround fix this on HDMI port. On Displayport, I haven't found a workaround
# http://www.ddcutil.com/nvidia/
sudo cd /etc/X11; sudo mkdir xorg.conf.d; sudo vim xorg.conf
# add following lines
    Section "Device"
        Driver "nvidia"
        Identifier "Dev0"
        Option     "RegistryDwords"  "RMUseSwI2c=0x01; RMI2cSpeed=100"
        # solves problem of i2c errors with nvidia driver
        # per https://devtalk.nvidia.com/default/topic/572292/-solved-does-gddccontrol-work-for-anyone-here-nvidia-i2c-monitor-display-ddc/#4309293
    EndSection

